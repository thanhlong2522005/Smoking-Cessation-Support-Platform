<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Blog Chia S·∫ª Kinh Nghi·ªám Cai Thu·ªëc</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f9f9f9;
        padding: 30px;
      }

      .blog-container {
        max-width: 900px;
        margin: auto;
      }

      .blog-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .blog-post {
        background: white;
        padding: 20px;
        margin-bottom: 25px;
        border-radius: 10px;
        border: 1px solid #ddd;
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
      }

      .blog-post:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 12px rgba(0, 0, 0, 0.1);
      }

      .blog-post h3 a {
        text-decoration: none;
        color: #007bff;
      }

      .blog-post h3 a:hover {
        text-decoration: underline;
      }

      .blog-post small {
        color: #194e7c;
      }

      .btn-write {
        background-color: #007bff;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        text-decoration: none;
      }

      .btn-write:hover {
        background-color: #0056b3;
        color: white;
      }

      .btn-delete {
        margin-top: 10px;
      }

      .form-section {
        background: #ffffff;
        border: 1px solid #ddd;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 30px;
      }

      textarea {
        resize: vertical;
      }
    </style>
  </head>

  <body>
    <div class="blog-container">
      <div class="blog-header">
        <h2>üì∞ Blog Chia S·∫ª Kinh Nghi·ªám Cai Thu·ªëc</h2>
        <div class="d-flex gap-2 mt-2">
          <a class="btn-write" th:href="@{/blogs/write}">üìù Vi·∫øt b√†i chia s·∫ª</a>
          <a class="btn btn-outline-secondary" th:href="@{/dashboard}"
            >‚Üê V·ªÅ B·∫£ng ƒêi·ªÅu Khi·ªÉn</a
          >
        </div>
      </div>

      <!-- ‚úÖ Form G·ª≠i L·ªùi ƒê·ªông Vi√™n -->
      <div class="form-section">
        <h5>üíå G·ª≠i l·ªùi ƒë·ªông vi√™n</h5>
        <form action="/blog/sendMotivation" method="post">
          <div class="mb-2">
            <input
              type="text"
              name="receiverUsername"
              class="form-control"
              placeholder="T√™n ng∆∞·ªùi nh·∫≠n"
              required
            />
          </div>
          <div class="mb-2">
            <textarea
              name="message"
              class="form-control"
              rows="3"
              placeholder="Nh·∫≠p l·ªùi ƒë·ªông vi√™n..."
              required
            ></textarea>
          </div>
          <button type="submit" class="btn btn-primary">
            G·ª≠i l·ªùi ƒë·ªông vi√™n
          </button>
        </form>
      </div>

      <!-- ‚úÖ Form Chia S·∫ª Huy Hi·ªáu -->
      <div class="form-section">
        <h5>üèÖ Chia s·∫ª huy hi·ªáu</h5>
        <form action="/blog/shareAchievement" method="post">
          <div class="mb-2">
            <input
              type="text"
              name="receiverUsername"
              class="form-control"
              placeholder="T√™n ng∆∞·ªùi nh·∫≠n"
              required
            />
          </div>
          <div class="mb-2">
            <select name="achievementId" class="form-select" required>
              <option
                th:each="ach : ${achievements}"
                th:value="${ach.id}"
                th:text="${ach.name}"
              >
                [Huy hi·ªáu]
              </option>
            </select>
          </div>
          <button type="submit" class="btn btn-success">
            Chia s·∫ª huy hi·ªáu
          </button>
        </form>
      </div>
      <a href="/chat/select" class="btn btn-outline-success mt-3"
        >üí¨ Chat v·ªõi Coach</a
      >
      <!-- ‚úÖ Th√¥ng b√°o -->
      <div
        th:if="${successMessage}"
        class="alert alert-success"
        th:text="${successMessage}"
      ></div>
      <div
        th:if="${errorMessage}"
        class="alert alert-danger"
        th:text="${errorMessage}"
      ></div>

      <!-- ‚úÖ Danh s√°ch b√†i vi·∫øt -->
      <div th:each="blog : ${blogs}" class="blog-post">
        <h3>
          <a th:href="@{'/blogs/' + ${blog.id}}" th:text="${blog.title}">
            [Ti√™u ƒë·ªÅ]
          </a>
        </h3>
        <small>
          ‚úçÔ∏è T√°c gi·∫£:
          <span th:text="${blog.author}"></span>
          | üìÖ Ng√†y:
          <span
            th:text="${#temporals.format(blog.createdAt, 'dd/MM/yyyy HH:mm')}"
          ></span>
        </small>

        <p class="mt-3" th:text="${#strings.abbreviate(blog.content, 200)}">
          [N·ªôi dung r√∫t g·ªçn]
        </p>

        <!-- ‚úÖ Ch·ªâ hi·ªán n√∫t x√≥a n·∫øu l√† t√°c gi·∫£ ho·∫∑c admin -->
        <div
          th:if="${blog.author == #authentication.name or userRole == 'ADMIN'}"
        >
          <a
            th:href="@{'/blog/delete/' + ${blog.id}}"
            class="btn btn-sm btn-danger btn-delete"
            onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën xo√° b√†i vi·∫øt n√†y?');"
          >
            üóë Xo√° b√†i vi·∫øt
          </a>
        </div>
      </div>
    </div>
  </body>
</html>
